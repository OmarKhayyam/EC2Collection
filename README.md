# Workshop on Recommendation Engine using Apache Spark on Amazon Elastic MapReduce (EMR)
This is the detailed description of the initial setup before attending the workshop on building a Recommendation Engine using Apache Spark running on [Amazon EMR](https://aws.amazon.com/emr/). The workshop uses Python 3, [Zeppelin](https://zeppelin.apache.org/) and the [Spark DataFrames API](https://spark.apache.org/docs/2.1.0/sql-programming-guide.html). Amazon EMR comes with python3 installed on all the cluster nodes, we use emr-5.5.0 release for this workshop, and we configure our EMR cluster to have Zeppelin & Spark installed at launch. Refer to the Cloudformation template for more details.

## Pull all the files in this Git repository.
`bootstrap_EMRCluster.sh` - This file sets up the bootstrap_zeppelin.sh to use later.

`bootstrap_zeppelin.sh` - A misnomer actually, this file changes the interpreter we will use by default in the interpreter.json file

`personalRatings.txt` - This is the file that contains a sample set of movies that user zero(0) has rated. To see which movies these are, you can have a look at the rateMovies script. This file is generated by rateMovies script or you can manually edit the ratigs to eeach of the movies.

`rateMovies` - This is the script that is used to rate movies and generate the `personalRatings.txt` file and uploads it to an S3 bucket of your choice. We run this script without any parameters, if you are not able to run this script, just edit `personalRatings.txt` with the ratings for yoru choice for the movies and upload it to the S3 bucket you will create in the next step.

## Creating a bucket
With a name of your choice in the region of your choice. Note, this will decide in which region your EMR cluster will be launched, it will be the same as the region where the bucket is created. You can [create an Amazon S3 bucket using the AWS Management Console](http://docs.aws.amazon.com/AmazonS3/latest/gsg/CreatingABucket.html) or using the CLI, here is an example of creating the bucket using AWS CLI.

`aws s3 mb s3://your-bucket-name`

## Prepare the scripts for use later
Change the following files to use the name of your new bucket instead of the string __myBucket__.

`bootstrap_EMRCluster.sh` - Replace __myBucket__ with the name of the bucket you just created above.

`rateMovies` - Replace __myBucket__ with the name of the bucket you just created above. If you are going to modify the `personalRatings.txt` file by hand, you don't need to do modify this file.

## Getting the Data
We will be using the [Movielens 100K dataset](https://grouplens.org/datasets/movielens/100k/) for this exercise. Download it, unzip the bundle, and upload all the files to the bucket you just created above.
## Run the Cloudformation template
Now, open the Cloudformation console in the AWS Management Console, and create the stack, the template will ask for some parameters, make sure you already have them, they are,

...An EC2 Keypair name

...Location of the bootstrap actions script

...A subnet Id

...Log URI

## After the stack is created
We will need to modify the Security group of the master node in the EMR cluster. You can find the Master node's security group by looking at the cluster details thus,

`aws emr describe-cluster --cluster-id j-xxxxxxxxxxx`
